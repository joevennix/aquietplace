<!--
  A localStorage shim for schemes that don't support it,
  like data: in Chrome.
-->
<!doctype html>
<html>
<body>
<script>
window.onmessage = function(e) {
	// simply evaluate and send back the result.
	var origin = e.origin || 'data://';
	var key = e.data.key;
	var value = null;

	if (e.data) {
		if (e.data.set) {
			localStorage[origin] = localStorage[origin] || {};
			localStorage[origin][e.data.key] = e.data.value;
		} else if (e.data.get) {
			value = localStorage[origin] && localStorage[origin][key];
			e.source.postMessage({value: value, key: key}, '*');
		}
	}
};
</script>
</body>
</html>